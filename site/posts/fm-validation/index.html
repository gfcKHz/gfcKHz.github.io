
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Validation logs and signal-processing deep dives for the metal-sdr project.">
      
      
      
      
      
        <link rel="next" href="../fm-geometry/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Ghost in the Capture - gfcKHz</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    
      <link rel="stylesheet" href="../../styles/custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ghost-in-the-capture" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="gfcKHz" class="md-header__button md-logo" aria-label="gfcKHz" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            gfcKHz
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Ghost in the Capture
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="gfcKHz" class="md-nav__button md-logo" aria-label="gfcKHz" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    gfcKHz
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Posts
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Posts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1_1" id="__nav_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Ghost in the Capture
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Ghost in the Capture
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#metal_sdr" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metal_SDR
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#field-journal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Field Journal
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Field Journal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wide-bandwidth-source-ambiguity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Wide-bandwidth Source Ambiguity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#single-feature-validation-fallacy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Single-feature Validation fallacy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#carrier-to-noise-ratio-needs-dimensional-consistency" class="md-nav__link">
    <span class="md-ellipsis">
      
        Carrier-to-Noise ratio needs dimensional consistency
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#welch-psd-requires-bin-width-scaling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Welch PSD requires bin-width scaling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adjacent-channel-rejection-needs-matching-bandwidths" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adjacent-channel rejection needs matching bandwidths
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rtl-sdr-normalization-must-be-symmetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        RTL-SDR normalization must be symmetric
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-this-enables" class="md-nav__link">
    <span class="md-ellipsis">
      
        What This Enables
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#we-all-knew-this-was-coming" class="md-nav__link">
    <span class="md-ellipsis">
      
        We All Knew This Was Coming
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fm-geometry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Latent Space
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fm-cryptography/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Entropy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#metal_sdr" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metal_SDR
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#field-journal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Field Journal
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Field Journal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wide-bandwidth-source-ambiguity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Wide-bandwidth Source Ambiguity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#single-feature-validation-fallacy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Single-feature Validation fallacy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#carrier-to-noise-ratio-needs-dimensional-consistency" class="md-nav__link">
    <span class="md-ellipsis">
      
        Carrier-to-Noise ratio needs dimensional consistency
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#welch-psd-requires-bin-width-scaling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Welch PSD requires bin-width scaling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adjacent-channel-rejection-needs-matching-bandwidths" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adjacent-channel rejection needs matching bandwidths
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rtl-sdr-normalization-must-be-symmetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        RTL-SDR normalization must be symmetric
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-this-enables" class="md-nav__link">
    <span class="md-ellipsis">
      
        What This Enables
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#we-all-knew-this-was-coming" class="md-nav__link">
    <span class="md-ellipsis">
      
        We All Knew This Was Coming
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="ghost-in-the-capture">Ghost in the Capture<a class="headerlink" href="#ghost-in-the-capture" title="Permanent link">&para;</a></h1>
<hr />
<h2 id="metal_sdr">Metal_SDR<a class="headerlink" href="#metal_sdr" title="Permanent link">&para;</a></h2>
<p>A measurement <a href="https://github.com/gfcKHz/Metal_SDR">tool</a> for RF captures. SDR feeds SigMF logs, fingerprints extract deterministic metrics (peak interpolation, CNR, bandwidth, adjacent-channel rejection), and regression tests keep the math anchored to physics rather than intention. The sections below walk through the failure modes uncovered while building that pipeline and the corrections layered in so each capture carries defensible results.</p>
<hr />
<h2 id="field-journal">Field Journal<a class="headerlink" href="#field-journal" title="Permanent link">&para;</a></h2>
<p><strong>Why FM broadcast?</strong> It’s a stable, public signal I can listen to, analyze and validate within an acceptable amount of error based on my hardware constraints. Stations occupy ~200 kHz and have published parameters for stress testing the capture loop before facing OFDM systems.</p>
<h3 id="wide-bandwidth-source-ambiguity">Wide-bandwidth Source Ambiguity<a class="headerlink" href="#wide-bandwidth-source-ambiguity" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Setup:</strong> RTL-SDR @ 2.4 Msps sweeping FM broadcast from 100–142 MHz.  </li>
<li><strong>Symptom:</strong> metadata said “105.9 MHz,” but the stored spectrum often contained 105.4 or 106.3 MHz whenever those stations were louder.  </li>
<li><strong>Lesson:</strong> tuner settings document <em>intent</em>. Without a validation step, a wide window silently captures whichever emitter dominates the moment.</li>
</ul>
<p><strong>Course correction:</strong> narrow each capture window around the target station; log the measured peak frequency (post-capture) instead of trusting the tuner.</p>
<h3 id="single-feature-validation-fallacy">Single-feature Validation fallacy<a class="headerlink" href="#single-feature-validation-fallacy" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Setup:</strong> narrowed windows but still used “maximum FFT bin” as the only check.  </li>
<li><strong>Symptom:</strong> station IDs drifted ±0.5 MHz as the dongle’s oscillator warmed up; adjacent-channel interference triggered new entries in the manifest.  </li>
<li><strong>Lesson:</strong> a single feature can’t tell “tuner drift” from “new signal.” Multi-feature fingerprints (peak interpolation, CNR, bandwidth, adjacent rejection, roll-off) are mandatory.</li>
</ul>
<p>The multi-feature fix lives in (<code>fm_fingerprint.py</code>): takes each capture and emits a structured feature vector (peak frequency, CNR, 3 dB bandwidth, adjacent-channel rejection, rolloff asymmetry). Even the “find the peak” step is formalized with a three-point parabolic interpolation,</p>
<div class="arithmatex">\[
\large \delta = \tfrac{1}{2}\,\frac{P_{k-1}-P_{k+1}}{P_{k-1}-2P_k+P_{k+1}}, \qquad f_{\text{peak}} = f_k + \delta\,\Delta f,
\]</div>
<p>where <span class="arithmatex">\(P_i\)</span> are log-PSD samples and <span class="arithmatex">\(\Delta f\)</span> is the FFT bin spacing (<a href="https://github.com/gfcKHz/Metal_SDR/blob/master/scripts/fingerprinting/README.md#parabolic-peak-interpolation">scripts/fingerprinting</a>). That keeps every capture anchored to the same peak-estimation math instead of trusting one noisy FFT bin.</p>
<h3 id="carrier-to-noise-ratio-needs-dimensional-consistency">Carrier-to-Noise ratio needs dimensional consistency<a class="headerlink" href="#carrier-to-noise-ratio-needs-dimensional-consistency" title="Permanent link">&para;</a></h3>
<p>Identical night captures reported CNR swings between 50–72 dB because the numerator summed carrier PSD bins <span class="arithmatex">\(\left(\sum_{k\in\mathcal{C}} S[k]\right)\)</span> while the denominator used <em>average</em> noise PSD <span class="arithmatex">\(\left(|\mathcal{N}|^{-1} \sum_{k\in\mathcal{N}} S[k]\right)\)</span>. That mismatch silently injects ≈22 dB of phantom CNR by counting <span class="arithmatex">\(|\mathcal{C}|\)</span> extra bins. The correct form compares mean PSD on both sides:</p>
<div class="arithmatex">\[
\bar{S}_{\text{carrier}} = \frac{1}{|\mathcal{C}|} \sum_{k \in \mathcal{C}} S[k], \qquad
\bar{S}_{\text{noise}} = \frac{1}{|\mathcal{N}|} \sum_{k \in \mathcal{N}} S[k], \qquad
\mathrm{CNR}_{\text{correct}} = 10 \log_{10} \left( \frac{\bar{S}_{\text{carrier}}}{\bar{S}_{\text{noise}}} \right)
\]</div>
<p><strong>Fix:</strong> compare mean PSD on both sides:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># scripts/fingerprinting/fm_fingerprint.py:118</span>
<span class="n">carrier_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">freqs</span> <span class="o">-</span> <span class="n">peak_freq_hz</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">carrier_bw_hz</span>
<span class="n">carrier_power_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">psd</span><span class="p">[</span><span class="n">carrier_mask</span><span class="p">])</span>

<span class="n">noise_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">freqs</span> <span class="o">-</span> <span class="n">peak_freq_hz</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">guard_bw_hz</span>
<span class="n">noise_bins</span> <span class="o">=</span> <span class="n">psd</span><span class="p">[</span><span class="n">noise_mask</span><span class="p">]</span>
<span class="n">noise_floor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">noise_bins</span><span class="p">,</span> <span class="n">kth</span><span class="p">)[:</span><span class="n">n_bins</span><span class="p">])</span>

<span class="n">cnr_db</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">carrier_power_density</span> <span class="o">/</span> <span class="n">noise_floor</span><span class="p">)</span>
</code></pre></div>
<p>Both sides stay as mean PSD:</p>
<p>The corrected ratio stays in mean-PSD land: carrier and noise are averaged over matching bandwidths before taking <span class="arithmatex">\(10\log_{10}\)</span> of their quotient.</p>
<h3 id="welch-psd-requires-bin-width-scaling">Welch PSD requires bin-width scaling<a class="headerlink" href="#welch-psd-requires-bin-width-scaling" title="Permanent link">&para;</a></h3>
<p><code>signal.welch(..., scaling='density')</code> returns PSD values <span class="arithmatex">\(S[k]\)</span> in <span class="arithmatex">\([\text{W/Hz}]\)</span>. Summing those values without multiplying by the frequency bin width <span class="arithmatex">\(\Delta f\)</span> makes results depend on FFT length. The conversion is straightforward:</p>
<div class="arithmatex">\[
P_{\text{carrier}} = \left( \sum_{k \in \mathcal{C}} S[k] \right) \Delta f, \qquad \Delta f = f[k+1] - f[k]
\]</div>
<p>All metrics that integrate PSD now multiply by <code>freq_resolution</code>; ratios stay between averaged densities.</p>
<h3 id="adjacent-channel-rejection-needs-matching-bandwidths">Adjacent-channel rejection needs matching bandwidths<a class="headerlink" href="#adjacent-channel-rejection-needs-matching-bandwidths" title="Permanent link">&para;</a></h3>
<p>Same pitfall as CNR: the original code integrated carrier power but compared it against the average adjacent-channel power. Averaging PSD over identical ±50 kHz windows fixes the mismatch:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># scripts/fingerprinting/fm_fingerprint.py:205</span>
<span class="n">carrier_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">freqs</span> <span class="o">-</span> <span class="n">peak_freq_hz</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">50e3</span>
<span class="n">carrier_power_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">psd</span><span class="p">[</span><span class="n">carrier_mask</span><span class="p">])</span>

<span class="n">left_center</span> <span class="o">=</span> <span class="n">peak_freq_hz</span> <span class="o">-</span> <span class="n">channel_spacing_hz</span>
<span class="n">left_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">freqs</span> <span class="o">-</span> <span class="n">left_center</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">50e3</span>
<span class="n">left_power_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">psd</span><span class="p">[</span><span class="n">left_mask</span><span class="p">])</span>

<span class="n">right_center</span> <span class="o">=</span> <span class="n">peak_freq_hz</span> <span class="o">+</span> <span class="n">channel_spacing_hz</span>
<span class="n">right_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">freqs</span> <span class="o">-</span> <span class="n">right_center</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">50e3</span>
<span class="n">right_power_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">psd</span><span class="p">[</span><span class="n">right_mask</span><span class="p">])</span>

<span class="n">rejection_db</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span>
    <span class="n">carrier_power_density</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mf">1e-15</span><span class="p">,</span> <span class="p">(</span><span class="n">left_power_density</span> <span class="o">+</span> <span class="n">right_power_density</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="rtl-sdr-normalization-must-be-symmetric">RTL-SDR normalization must be symmetric<a class="headerlink" href="#rtl-sdr-normalization-must-be-symmetric" title="Permanent link">&para;</a></h3>
<p>Dividing raw samples by 127.5 placed zero halfway between two quantization codes. Dividing by 128.0 centers zero exactly, removing a deterministic DC bias:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># scripts/capture/backends/rtl_sdr.py:95</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">temp_path</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">iq_float</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="o">-</span> <span class="mf">127.5</span><span class="p">)</span> <span class="o">/</span> <span class="mf">128.0</span>
<span class="n">iq</span> <span class="o">=</span> <span class="n">iq_float</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">iq_float</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
</code></pre></div>
<hr />
<h2 id="testing">Testing<a class="headerlink" href="#testing" title="Permanent link">&para;</a></h2>
<p>Once the signal chain math was honest, I still needed proof. The regression suite generates synthetic IQ blocks with known SNR/frequency to ensure the extractor reports what physics says it should:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">test_cnr_with_known_signal</span><span class="p">():</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mf">2.4e6</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>

    <span class="n">signal_power</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">carrier</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">signal_power</span><span class="p">)</span>

    <span class="n">target_snr_db</span> <span class="o">=</span> <span class="mf">30.0</span>
    <span class="n">noise_power</span> <span class="o">=</span> <span class="n">signal_power</span> <span class="o">/</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">target_snr_db</span> <span class="o">/</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">noise_power</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">iq</span> <span class="o">=</span> <span class="n">carrier</span> <span class="o">+</span> <span class="n">noise</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">extract_fingerprint</span><span class="p">(</span><span class="n">iq</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex64</span><span class="p">),</span> <span class="n">fs</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="s2">&quot;cnr_db&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">target_snr_db</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">2.0</span>
</code></pre></div>
<p>There’s a companion test for frequency accuracy (parabolic interpolation within 100 Hz). Together they act as the “analysis” block’s tripwire: any change to the fingerprint code reruns the synthetic suite before merging.</p>
<hr />
<h2 id="what-this-enables">What This Enables<a class="headerlink" href="#what-this-enables" title="Permanent link">&para;</a></h2>
<p><strong>Propagation tracking:</strong> does WQXR's carrier drift 200 Hz warmer at 2 PM than at 2 AM? Does atmospheric ducting at night pull in stations from 300+ miles away? Multi-day captures with sub-100 Hz peak interpolation and timestamped CNR logs answer questions that spectrum analyzer screenshots cannot.</p>
<p><strong>Interference detection:</strong> when CNR drops 8 dB between successive captures, or when adjacent-channel rejection degrades from 40 dB to 18 dB, the pipeline flags it. Cross-reference against weather data, time of day, and nearby capture sessions to distinguish atmospheric fade from a new emitter appearing in-band.</p>
<p><strong>Relational grounding for ML:</strong> models hallucinate, just like people do. None of us interface with reality directly. We experience it through peripherals, sensors, and neurophysiological smoothing functions that hide thermal jitter and hardware drift. Nobuo reminds us that we understand an object only through its <a href="https://www.math3ma.com/blog/the-yoneda-perspective">relationships</a>. There is no true representation, only the web of all possible representations. Whatever we believe to be the intrinsic meaning of an object is just a useful abstraction, true meaning lies between networks of relations between different objects. A SigMF capture is meaningful when the relationships it claims (frequency, CNR, bandwidth) match the measurable traces coming off the radio. Validation keeps those morphisms honest so the model’s hallucinations stay tethered to the same perceptual field the hardware saw.</p>
<p><strong>Foundation:</strong> FM broadcast is the introduction. If the same CNR checks, bandwidth validation, and adjacent-channel rejection metrics can scale to LTE downlink (15 kHz subcarriers, 20 MHz channels), WiFi OFDM (312.5 kHz subcarriers, 20/40/80 MHz channels), and LoRa chirps (125–500 kHz), then the bladeRF backend brings the same regression harness.</p>
<hr />
<blockquote>
<p>So crazy thing I learned recently, was that most audio models don’t actually operate on audio at all. There are some bespoke ones that do, but the majority convert the audio to a spectrogram then pass that spectrogram into an image2* model. Img2img for new audio, reconstruct the spectrogram with encodec at the output layer. I have also been playing with that, re-representing patches of tokens as a unified vector, representing that vector in a pixel group, with some masked pixels for pattern learning. - SashimiSaketoro</p>
</blockquote>
<hr />
<h2 id="we-all-knew-this-was-coming">We All Knew This Was Coming<a class="headerlink" href="#we-all-knew-this-was-coming" title="Permanent link">&para;</a></h2>
<blockquote>
<p>“Long-term, &gt;99% of input and output for AI models will be <a href="https://x.com/elonmusk/status/1980430707706196359">photons</a>. Nothing else scales.”<br />
— Elon Musk replying to Andrej Karpathy on DeepSeek-OCR</p>
</blockquote>
<p>So all the cool kids are beam <a href="../fm-geometry/">splitting</a> audio via pixel space and I'm late to the party as usual. This is when it naturally occurred to me that I haven't been paying attention to what's really going on (and it doesn't help that I don't even know where my glasses are right now). Perception is computationally bounded, and <a href="https://en.wikipedia.org/wiki/Human_echolocation#Ben_Underwood">vision</a> transforms once the perceptual map reshapes to the relational geometry that emerges from constraints. Maybe I'm just intercepting a broadcast from a <a href="https://cyclostationary.blog/2016/03/22/csp-estimators-the-strip-spectral-correlation-analyzer/">CDMA downlink</a>, the kind William mapped long before the noise took <a href="https://cyclostationarity.com/wp-content/uploads/2022/12/202210131027.pdf">shape</a>. </p>
<hr />
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ol>
<li>Gardner, William A. <em>Statistical Spectral Analysis: A Nonprobabilistic Theory</em>. Prentice Hall, 1987. [Cyclostationary coherence framework underpinning the validation heuristics]</li>
<li>Gardner, William A. "A Unifying View of Coherence in Signal Processing." <em>Signal Processing</em> 29 (1992): 113–140.</li>
<li>Bradley, Tai-Danae. "The Yoneda Perspective." Math3ma, May 2017. https://www.math3ma.com/blog/the-yoneda-perspective. [Intuition primer that motivates the Yoneda link in plain language]</li>
<li>Ibn al-Haytham. <em>The Optics of Ibn al-Haytham: Books I–III, On Direct Vision</em>. Translated with introduction and commentary by A. I. Sabra. London: The Warburg Institute, University of London, 1989. Book 2, Chapter 3, "On the manner of perceiving each of the particular properties."</li>
<li>Reed, Graham T., and Andrew P. Knights. <em>Silicon Photonics: An Introduction</em>. Chichester: John Wiley &amp; Sons, 2004. Chapter 8.4, "Raman Excitation."</li>
<li>Wells, H. G. <em>The Invisible Man</em>. London: C. Arthur Pearson, 1897.</li>
<li>Spooner, Chad. "Correcting the Record: Comments on Wireless Signal Representation Techniques for Automatic Modulation Classification." (2022).</li>
<li>Wei, Haoran, Yaofeng Sun, and Yukun Li. "DeepSeek-OCR: Contexts Optical Compression." arXiv:2510.18234 (2025). [Optical context compression for high-accuracy OCR with constrained vision tokens]</li>
<li>Shao, Chenze, Darren Li, Fandong Meng, and Jie Zhou. "Continuous Autoregressive Language Models." arXiv:2510.27688 (2025). [Continuous next-vector generation to increase semantic bandwidth per decoding step]</li>
<li>O'Shea, Timothy J., Johnathan Corgan, and T. Charles Clancy. "Convolutional Radio Modulation Recognition Networks." arXiv:1602.04105 (2016). [CNN baselines for end-to-end modulation recognition]</li>
<li>Peng, Shengliang, Hanyu Jiang, Huaxia Wang, Hathal Alwageed, Yu Zhou, Marjan Mazrouei Sebdani, and Yu-Dong Yao. "Modulation Classification Based on Signal Constellation Diagrams and Deep Learning." <em>IEEE Transactions on Neural Networks and Learning Systems</em> 30, no. 3 (2019): 718–727. https://doi.org/10.1109/TNNLS.2018.2850703. [Constellation image CNN that set the standard for diagram-first modulation tasks]</li>
<li>Zhang, Hao, Fuhui Zhou, Hongyang Du, Qihui Wu, and Chau Yuen. "Revolution of Wireless Signal Recognition for 6G: Recent Advances, Challenges and Future Directions." <em>IEEE Communications Surveys &amp; Tutorials</em> (2025). https://doi.org/10.1109/COMST.2025.3569427. [6G-era survey of modulation/fingerprint pipelines, open problems, and data requirements]</li>
<li>Wolfram, Stephen. "I Have a Theory Too: The Challenge and Opportunity of Avocational Science." August 2025. https://writings.stephenwolfram.com/2025/08/i-have-a-theory-too-the-challenge-and-opportunity-of-avocational-science/. [Framework for keeping hobby-grade theory accountable]</li>
</ol>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <nav class="md-footer__inner md-grid" aria-label="Footer">
    
    
    <a href="../fm-geometry/" class="md-footer__link md-footer__link--next" aria-label="Next: Latent Space">
      <div class="md-footer__title">
        <span class="md-footer__direction">Next</span>
        <div class="md-ellipsis">Latent Space</div>
      </div>
      <div class="md-footer__button md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
      </div>
    </a>
    
  </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.sections", "navigation.top", "content.code.annotate", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
      
        <script src="../../javascripts/math.js"></script>
      
    
  </body>
</html>